{"version":3,"file":"index.modern.js","sources":["../src/FunnelChart.tsx"],"sourcesContent":["import * as React from 'react'\nimport './index.css'\n\ninterface IFunnelChartProps {\n  data: any\n  title?: string\n  showValues: boolean\n  showNames: boolean\n  pallette: string[]\n  showRunningTotal: boolean\n  heightRelativeToValue: boolean\n  chartHeight?: number\n  chartWidth?: number\n  style?: any\n  getRowStyle?: (row: any) => any\n  getRowNameStyle?: (row: any) => any\n  getRowValueStyle?: (row: any) => any\n  decorateValue?: (row: any, index: number, data: any) => any\n  getToolTip?: (row: any) => string\n  onRowClick?: (row: any) => void\n}\n\ninterface IFunnelChartState {}\n\nconst initialState: IFunnelChartState = {}\n\nclass FunnelChart extends React.Component<\n  IFunnelChartProps,\n  IFunnelChartState\n> {\n  static defaultProps = {\n    showValues: true,\n    showNames: true,\n    pallette: [\n      '#f14c14',\n      '#f39c35',\n      '#68BC00',\n      '#1d7b63',\n      '#4e97a8',\n      '#4466a3'\n    ],\n    showRunningTotal: false,\n    heightRelativeToValue: false\n  }\n\n  constructor(props: IFunnelChartProps) {\n    super(props)\n    this.state = initialState\n  }\n\n  setFunnelRows() {\n    const {\n      data,\n      showNames,\n      showValues,\n      showRunningTotal,\n      heightRelativeToValue,\n      chartHeight,\n      getRowStyle,\n      getRowNameStyle,\n      getRowValueStyle,\n      decorateValue,\n      getToolTip,\n      onRowClick\n    } = this.props\n    const rows = []\n    const totalValue = this.getTotalValue()\n\n    let sizePerValue = 0\n    if (heightRelativeToValue && totalValue > 0) {\n      let totalHeight = chartHeight\n      if (!totalHeight) {\n        totalHeight = 500\n        if (window.innerWidth < 500) {\n          totalHeight = 300\n        }\n      }\n      sizePerValue = totalHeight / totalValue\n    }\n\n    var runningTotal = totalValue\n    if (data) {\n      for (var i1 = 0; i1 < data.length; i1++) {\n        const thisRow = data[i1]\n        let showTitle = true\n        let showValue = true\n\n        if (thisRow.value >= 0) {\n          let rowStyle: any = {}\n          let rowTitleStyle: any = {}\n          let rowValueStyle: any = {}\n          const decoratedValue =\n            typeof decorateValue === 'function'\n              ? decorateValue(thisRow, i1, data)\n              : thisRow.value\n\n          if (typeof getRowStyle === 'function') {\n            rowStyle = getRowStyle(thisRow)\n          }\n          if (typeof getRowNameStyle === 'function') {\n            rowTitleStyle = getRowNameStyle(thisRow)\n          }\n          if (typeof getRowValueStyle === 'function') {\n            rowValueStyle = getRowValueStyle(thisRow)\n          }\n\n          if (heightRelativeToValue) {\n            const size = sizePerValue * thisRow.value\n            rowStyle.height = size + 'px'\n            rowStyle.maxHeight = size + 'px'\n            if (size < 65) {\n              showValue = false\n            }\n            if (size < 40) {\n              showTitle = false\n            }\n          }\n          if (thisRow.backgroundColor) {\n            rowStyle.backgroundColor = thisRow.backgroundColor\n          }\n          if (!rowStyle.backgroundColor) {\n            rowStyle.backgroundColor = this.props.pallette[\n              i1 % this.props.pallette.length\n            ]\n          }\n\n          if (!showNames) {\n            showTitle = false\n          }\n          if (!showValues) {\n            showValue = false\n          }\n\n          let toolTip = thisRow.name + '\\n' + runningTotal\n          if (typeof getToolTip === 'function') {\n            toolTip = getToolTip(thisRow)\n          }\n\n          if (typeof onRowClick === 'function') {\n            rowStyle.cursor = 'pointer'\n          }\n\n          rows.push(\n            <div\n              key={'funnel-pipeline-chart-row-' + thisRow.name}\n              className='funnel-pipeline-chart-row'\n              style={rowStyle}\n              title={toolTip}\n              onClick={\n                typeof onRowClick === 'function'\n                  ? () => onRowClick(thisRow)\n                  : undefined\n              }\n            >\n              <div>\n                {showTitle ? (\n                  <div\n                    className='funnel-pipeline-chart-title'\n                    style={rowTitleStyle}\n                  >\n                    {thisRow.name}\n                  </div>\n                ) : null}\n                {showValue ? (\n                  <div\n                    className='funnel-pipeline-chart-value'\n                    style={rowValueStyle}\n                  >\n                    {showRunningTotal ? runningTotal : decoratedValue}\n                  </div>\n                ) : null}\n              </div>\n            </div>\n          )\n        }\n\n        runningTotal = runningTotal - thisRow.value\n      }\n    }\n\n    return rows\n  }\n\n  getTotalValue() {\n    const { data } = this.props\n\n    let dataTotal = 0\n    if (data) {\n      for (var i1 = 0; i1 < data.length; i1++) {\n        dataTotal += data[i1].value\n      }\n    }\n\n    return dataTotal\n  }\n\n  render() {\n    const { title, style } = this.props\n\n    const chartStyles: any = {}\n    if (style) {\n      Object.assign(chartStyles, style)\n    }\n    if (this.props.chartWidth) {\n      chartStyles.maxWidth = this.props.chartWidth\n    }\n\n    return (\n      <div className='funnel-pipeline-chart' style={chartStyles}>\n        {title ? <h2 style={{ marginBottom: '30px' }}>{title}</h2> : null}\n        {this.setFunnelRows()}\n      </div>\n    )\n  }\n}\n\nexport default FunnelChart\n"],"names":["initialState","FunnelChart","props","state","setFunnelRows","data","showNames","showValues","showRunningTotal","heightRelativeToValue","chartHeight","getRowStyle","getRowNameStyle","getRowValueStyle","decorateValue","getToolTip","onRowClick","rows","totalValue","getTotalValue","sizePerValue","totalHeight","window","innerWidth","runningTotal","thisRow","i1","showTitle","showValue","value","rowStyle","rowTitleStyle","rowValueStyle","decoratedValue","size","height","maxHeight","backgroundColor","pallette","length","toolTip","name","cursor","push","React","key","className","style","title","onClick","undefined","dataTotal","render","chartStyles","Object","assign","chartWidth","maxWidth","marginBottom"],"mappings":"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"}